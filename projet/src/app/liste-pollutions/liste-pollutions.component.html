<div class="header">
    <h2>Liste des pollutions</h2>
    <div class="user-info">
        <button [routerLink]="['/favorites']" class="favorites-btn">
            ‚ù§Ô∏è Favoris <span class="badge">{{ favoritesCount$ | async }}</span>
        </button>
        <span>Connect√© : <strong>{{ utilisateur?.login }}</strong></span>
        <button type="button" (click)="logout()">D√©connexion</button>
    </div>
</div>

<div class="filter-bar">
    <button [routerLink]="['/pollutions/add']" class="add-btn">Ajouter une pollution</button>
    <div class="filter-group">
        <label for="filterType">Filtrer par type :</label>
        <select id="filterType" [(ngModel)]="selectedType">
            <option value="">-- Tous les types --</option>
            <option value="plastique">Plastique</option>
            <option value="chimique">Chimique</option>
            <option value="depot sauvage">D√©p√¥t sauvage</option>
            <option value="eau">Eau</option>
            <option value="air">Air</option>
            <option value="autre">Autre</option>
        </select>
    </div>
</div>

<ul *ngIf="pollutions$ | async as pollutions; else loading">
    <li *ngFor="let p of pollutions | filterByType:selectedType" [routerLink]="['/pollutions', p.id]">
        <div class="pollution-title">{{ p.titre }}</div>
        <div class="discovered-by" *ngIf="p.userId">D√©couvert par : ID #{{ p.userId }}</div>
        <div class="buttons-container">
            <button type="button" class="favorite-btn" [class.is-favorite]="isFavorite(p.id!)"
                (click)="toggleFavorite(p.id!); $event.stopPropagation()">
                {{ isFavorite(p.id!) ? '‚ù§Ô∏è Retirer' : 'ü§ç Ajouter' }}
            </button>
            <button [routerLink]="['/pollutions/edit', p.id]" (click)="$event.stopPropagation()">Modifier</button>
            <button type="button" *ngIf="p.id !== undefined" (click)="deletePollution(p.id!); $event.stopPropagation()">
                Supprimer
            </button>
        </div>
    </li>
</ul>

<ng-template #loading>Chargement‚Ä¶</ng-template>